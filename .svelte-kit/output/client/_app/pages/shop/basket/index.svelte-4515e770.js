import{S as X,i as Z,s as x,e as w,t as B,k as G,c as E,a as I,h as N,d as m,m as J,b as i,f as te,g as F,J as h,G as z,j as A,H as W,I as ge,R as L,ah as be,v as ke,ai as ye,L as fe,n as pe,o as P,p as ve,q as Q,w as se,x as ae,O as ue,K as T,y as le,a1 as we,W as Ee,B as oe,a6 as Ie,ad as qe,a7 as $e,a8 as Se,ab as Oe}from"../../../chunks/vendor-301d67fd.js";import{g as Te}from"../../../chunks/navigation-0e6511d1.js";import{b as R}from"../../../chunks/basket-83bbcfbb.js";import{u as de}from"../../../chunks/basket-e649ff40.js";import"../../../chunks/singletons-d1fb5791.js";function De(a){let e,t,s,r,o,l,p,c=Math.floor(a[1]+1)+"",f,v,_,u=Math.floor(a[1])+"",b,O,k,q,C,U;return{c(){e=w("div"),t=w("button"),s=B("+"),r=G(),o=w("div"),l=w("div"),p=w("strong"),f=B(c),v=G(),_=w("strong"),b=B(u),O=G(),k=w("button"),q=B("-"),this.h()},l($){e=E($,"DIV",{class:!0});var y=I(e);t=E(y,"BUTTON",{"aria-label":!0,class:!0});var n=I(t);s=N(n,"+"),n.forEach(m),r=J(y),o=E(y,"DIV",{class:!0});var d=I(o);l=E(d,"DIV",{class:!0,style:!0});var g=I(l);p=E(g,"STRONG",{style:!0,"aria-hidden":!0,class:!0});var M=I(p);f=N(M,c),M.forEach(m),v=J(g),_=E(g,"STRONG",{class:!0});var j=I(_);b=N(j,u),j.forEach(m),g.forEach(m),d.forEach(m),O=J(y),k=E(y,"BUTTON",{"aria-label":!0,class:!0});var H=I(k);q=N(H,"-"),H.forEach(m),y.forEach(m),this.h()},h(){i(t,"aria-label","Increase the counter by one"),i(t,"class","svelte-i1ru96"),te(p,"top","-100%"),i(p,"aria-hidden","true"),i(p,"class","svelte-i1ru96"),i(_,"class","svelte-i1ru96"),i(l,"class","counter-digits svelte-i1ru96"),te(l,"transform","translate(0, "+100*a[2]+"%)"),i(o,"class","counter-viewport svelte-i1ru96"),i(k,"aria-label","Decrease the counter by one"),i(k,"class","svelte-i1ru96"),i(e,"class","counter svelte-i1ru96")},m($,y){F($,e,y),h(e,t),h(t,s),h(e,r),h(e,o),h(o,l),h(l,p),h(p,f),h(l,v),h(l,_),h(_,b),h(e,O),h(e,k),h(k,q),C||(U=[z(t,"click",a[5]),z(k,"click",a[6])],C=!0)},p($,[y]){y&2&&c!==(c=Math.floor($[1]+1)+"")&&A(f,c),y&2&&u!==(u=Math.floor($[1])+"")&&A(b,u),y&4&&te(l,"transform","translate(0, "+100*$[2]+"%)")},i:W,o:W,d($){$&&m(e),C=!1,ge(U)}}}function Ce(a,e){return(a%e+e)%e}function Me(a,e,t){let s,r,o;L(a,R,v=>t(3,o=v));let{productObj:l}=e;const p=be();L(a,p,v=>t(1,r=v));const c=()=>R.set(de({Id:parseInt(l.id,10),Name:l.name,SalePrice:l.price,CurrentStock:l.currentStock},o,"incrementQuantity")),f=()=>R.set(de({Id:parseInt(l.id,10),Name:l.name,SalePrice:l.price,CurrentStock:l.currentStock},o,"decrementQuantity"));return a.$$set=v=>{"productObj"in v&&t(0,l=v.productObj)},a.$$.update=()=>{a.$$.dirty&1&&p.set(l.quantity),a.$$.dirty&2&&t(2,s=Ce(r,1))},[l,r,s,o,p,c,f]}class Ve extends X{constructor(e){super();Z(this,e,Me,De,x,{productObj:0})}}const Be=async(a,e)=>{const t=await a,r=await(await fetch("http://localhost:8080/create-checkout-session",{method:"POST",body:JSON.stringify(e)})).json(),o=await t.redirectToCheckout({sessionId:r.id});o.error&&alert(o.error.message)};function Ne(a){let e,t,s,r;return{c(){e=w("button"),t=B("Checkout"),this.h()},l(o){e=E(o,"BUTTON",{id:!0,class:!0});var l=I(e);t=N(l,"Checkout"),l.forEach(m),this.h()},h(){i(e,"id","checkout-button"),i(e,"class","goto-checkout svelte-1sid9oa")},m(o,l){F(o,e,l),h(e,t),s||(r=z(e,"click",a[4]),s=!0)},p:W,i:W,o:W,d(o){o&&m(e),s=!1,r()}}}function je(a,e,t){let s;L(a,R,c=>t(1,s=c));let r,{loading:o=!1}=e;ke(async()=>{t(0,r=await ye.loadStripe("pk_test_51HpvnTAk37gvJ51oYwywMtrDcDlL6FXuVY0aQ1EYEJUiw9MG70UElEMhhazqhhafUOslK1IugHRApQ7GWNUcnqT400dJ4HWjbp"))});const l=(c,f)=>{Be(c,f),t(3,o=!0)},p=()=>l(r,s);return a.$$set=c=>{"loading"in c&&t(3,o=c.loading)},[r,s,l,o,p]}class He extends X{constructor(e){super();Z(this,e,je,Ne,x,{loading:3})}}function he(a,e,t){const s=a.slice();return s[9]=e[t],s}function Ue(a){let e,t;return{c(){e=w("h1"),t=B("You have nothing in your basket, continue shopping"),this.h()},l(s){e=E(s,"H1",{class:!0});var r=I(e);t=N(r,"You have nothing in your basket, continue shopping"),r.forEach(m),this.h()},h(){i(e,"class","svelte-16yx21w")},m(s,r){F(s,e,r),h(e,t)},p:W,i:W,o:W,d(s){s&&m(e)}}}function Ge(a){let e=[],t=new Map,s,r,o,l,p,c,f,v,_,u,b,O,k,q,C=a[1];const U=n=>n[9].id;for(let n=0;n<C.length;n+=1){let d=he(a,C,n),g=U(d);t.set(g,e[n]=_e(g,d))}function $(n){a[8](n)}let y={};return a[3]!==void 0&&(y.loading=a[3]),b=new He({props:y}),Ie.push(()=>qe(b,"loading",$)),{c(){for(let n=0;n<e.length;n+=1)e[n].c();s=G(),r=w("div"),o=w("div"),l=w("h2"),p=B("Subtotal: \xA3"),c=B(a[2]),f=G(),v=w("h5"),_=B("Tax included & shipping calculated at checkout"),u=G(),se(b.$$.fragment),this.h()},l(n){for(let H=0;H<e.length;H+=1)e[H].l(n);s=J(n),r=E(n,"DIV",{class:!0});var d=I(r);o=E(d,"DIV",{class:!0});var g=I(o);l=E(g,"H2",{class:!0});var M=I(l);p=N(M,"Subtotal: \xA3"),c=N(M,a[2]),M.forEach(m),f=J(g),v=E(g,"H5",{class:!0});var j=I(v);_=N(j,"Tax included & shipping calculated at checkout"),j.forEach(m),u=J(g),ae(b.$$.fragment,g),g.forEach(m),d.forEach(m),this.h()},h(){i(l,"class","svelte-16yx21w"),i(v,"class","svelte-16yx21w"),i(o,"class","checkout svelte-16yx21w"),i(r,"class",k=T(a[4]?"mobile-total":"total")+" svelte-16yx21w")},m(n,d){for(let g=0;g<e.length;g+=1)e[g].m(n,d);F(n,s,d),F(n,r,d),h(r,o),h(o,l),h(l,p),h(l,c),h(o,f),h(o,v),h(v,_),h(o,u),le(b,o,null),q=!0},p(n,d){d&18&&(C=n[1],pe(),e=$e(e,d,U,1,n,C,t,s.parentNode,Se,_e,s,he),ve()),(!q||d&4)&&A(c,n[2]);const g={};!O&&d&8&&(O=!0,g.loading=n[3],Oe(()=>O=!1)),b.$set(g),(!q||d&16&&k!==(k=T(n[4]?"mobile-total":"total")+" svelte-16yx21w"))&&i(r,"class",k)},i(n){if(!q){for(let d=0;d<C.length;d+=1)Q(e[d]);Q(b.$$.fragment,n),q=!0}},o(n){for(let d=0;d<e.length;d+=1)P(e[d]);P(b.$$.fragment,n),q=!1},d(n){for(let d=0;d<e.length;d+=1)e[d].d(n);n&&m(s),n&&m(r),oe(b)}}}function _e(a,e){let t,s,r,o,l,p,c,f,v=e[9].name+"",_,u,b,O,k,q,C,U,$,y=`\xA3${(e[9].price*100*e[9].quantity/100).toFixed(2)}`,n,d,g,M,j,H,D,ee,re;function me(){return e[7](e[9])}return q=new Ve({props:{productObj:e[9]}}),{key:a,first:null,c(){t=w("div"),s=w("img"),p=G(),c=w("div"),f=w("h2"),_=B(v),b=G(),O=w("div"),k=w("div"),se(q.$$.fragment),U=G(),$=w("h4"),n=B(y),this.h()},l(V){t=E(V,"DIV",{class:!0});var S=I(t);s=E(S,"IMG",{src:!0,alt:!0,class:!0}),p=J(S),c=E(S,"DIV",{class:!0});var Y=I(c);f=E(Y,"H2",{class:!0});var ne=I(f);_=N(ne,v),ne.forEach(m),b=J(Y),O=E(Y,"DIV",{class:!0});var K=I(O);k=E(K,"DIV",{class:!0});var ie=I(k);ae(q.$$.fragment,ie),ie.forEach(m),U=J(K),$=E(K,"H4",{class:!0});var ce=I($);n=N(ce,y),ce.forEach(m),K.forEach(m),Y.forEach(m),S.forEach(m),this.h()},h(){ue(s.src,r=`https://enki.imgix.net/${e[9].id}-0?auto=format,compress`)||i(s,"src",r),i(s,"alt",o=`${e[9].name}`),i(s,"class",l=T(e[4]?"mobile-product-img":"product-img")+" svelte-16yx21w"),i(f,"class",u=T(e[4]?"mobile-product-name":"product-name")+" svelte-16yx21w"),i(k,"class",C=T(e[4]?"mobile-quantity":"quantity")+" svelte-16yx21w"),i($,"class",d=T(e[4]?"mobile-product-total":"product-total")+" svelte-16yx21w"),i(O,"class",g=T(e[4]?"mobile-quantity-and-price":"quantity-and-price")+" svelte-16yx21w"),i(c,"class",M=T(e[4]?"mobile-product-details":"product-details")+" svelte-16yx21w"),i(t,"class",j=T(e[4]?"mobile-product":"product")+" svelte-16yx21w"),this.first=t},m(V,S){F(V,t,S),h(t,s),h(t,p),h(t,c),h(c,f),h(f,_),h(c,b),h(c,O),h(O,k),le(q,k,null),h(O,U),h(O,$),h($,n),D=!0,ee||(re=z(s,"click",me),ee=!0)},p(V,S){e=V,(!D||S&2&&!ue(s.src,r=`https://enki.imgix.net/${e[9].id}-0?auto=format,compress`))&&i(s,"src",r),(!D||S&2&&o!==(o=`${e[9].name}`))&&i(s,"alt",o),(!D||S&16&&l!==(l=T(e[4]?"mobile-product-img":"product-img")+" svelte-16yx21w"))&&i(s,"class",l),(!D||S&2)&&v!==(v=e[9].name+"")&&A(_,v),(!D||S&16&&u!==(u=T(e[4]?"mobile-product-name":"product-name")+" svelte-16yx21w"))&&i(f,"class",u);const Y={};S&2&&(Y.productObj=e[9]),q.$set(Y),(!D||S&16&&C!==(C=T(e[4]?"mobile-quantity":"quantity")+" svelte-16yx21w"))&&i(k,"class",C),(!D||S&2)&&y!==(y=`\xA3${(e[9].price*100*e[9].quantity/100).toFixed(2)}`)&&A(n,y),(!D||S&16&&d!==(d=T(e[4]?"mobile-product-total":"product-total")+" svelte-16yx21w"))&&i($,"class",d),(!D||S&16&&g!==(g=T(e[4]?"mobile-quantity-and-price":"quantity-and-price")+" svelte-16yx21w"))&&i(O,"class",g),(!D||S&16&&M!==(M=T(e[4]?"mobile-product-details":"product-details")+" svelte-16yx21w"))&&i(c,"class",M),(!D||S&16&&j!==(j=T(e[4]?"mobile-product":"product")+" svelte-16yx21w"))&&i(t,"class",j)},i(V){D||(Q(q.$$.fragment,V),H||fe(()=>{H=we(t,Ee,{}),H.start()}),D=!0)},o(V){P(q.$$.fragment,V),D=!1},d(V){V&&m(t),oe(q),ee=!1,re()}}}function Je(a){let e,t,s,r,o,l,p;fe(a[6]);const c=[Ge,Ue],f=[];function v(_,u){return _[1].length?0:1}return t=v(a),s=f[t]=c[t](a),{c(){e=w("div"),s.c(),this.h()},l(_){e=E(_,"DIV",{class:!0,style:!0});var u=I(e);s.l(u),u.forEach(m),this.h()},h(){i(e,"class","container svelte-16yx21w"),i(e,"style",r=`cursor: ${a[3]?"wait":"default"}`)},m(_,u){F(_,e,u),f[t].m(e,null),o=!0,l||(p=z(window,"resize",a[6]),l=!0)},p(_,[u]){let b=t;t=v(_),t===b?f[t].p(_,u):(pe(),P(f[b],1,1,()=>{f[b]=null}),ve(),s=f[t],s?s.p(_,u):(s=f[t]=c[t](_),s.c()),Q(s,1),s.m(e,null)),(!o||u&8&&r!==(r=`cursor: ${_[3]?"wait":"default"}`))&&i(e,"style",r)},i(_){o||(Q(s),o=!0)},o(_){P(s),o=!1},d(_){_&&m(e),f[t].d(),l=!1,p()}}}function We(a,e,t){let s,r,o;L(a,R,u=>t(1,o=u));let l,p,c=!1;function f(){t(0,s=window.outerWidth)}const v=u=>Te(`/shop/product/${u.id}`);function _(u){c=u,t(3,c)}return a.$$.update=()=>{a.$$.dirty&34&&(t(5,l=o.map(u=>({total:u.price*100*u.quantity/100}))),t(2,p=l.reduce((u,b)=>b.total+u,0).toFixed(2))),a.$$.dirty&1&&t(4,r=s<960)},t(0,s=0),[s,o,p,c,r,l,f,v,_]}class Ye extends X{constructor(e){super();Z(this,e,We,Je,x,{})}}function Fe(a){let e,t;return e=new Ye({}),{c(){se(e.$$.fragment)},l(s){ae(e.$$.fragment,s)},m(s,r){le(e,s,r),t=!0},p:W,i(s){t||(Q(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}const Ke=!0;class Le extends X{constructor(e){super();Z(this,e,null,Fe,x,{})}}export{Le as default,Ke as prerender};
